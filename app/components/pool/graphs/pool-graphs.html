<bl-banner *ngIf="startTaskFailedError" fixMessage="Edit the start task" [fix]="openEditStartTask">
    <div message>It seems like the start task is failing on many nodes. ({{startTaskFailedError.failedNodes}}/{{startTaskFailedError.nodeCount}})</div>
    <div [other-fix]="rebootFailedNodes" fixMessage="Reboot failed nodes"></div>
    <div [other-fix]="rebootFailedNodes" fixMessage="Reimage failed nodes"></div>
</bl-banner>
<div class="charts-previews">
    <div class="preview" (click)="focusGraph(AvailableGraph.Heatmap)" [class.focused]="focusedGraph === AvailableGraph.Heatmap">
        <div class="label">Heatmap</div>
        <div class="small-preview">
            <bl-nodes-heatmap [pool]="pool" [nodes]="nodes" [showRunningTasks]="false" [showLegend]="false" [interactive]="false" [limitNode]="10"></bl-nodes-heatmap>
        </div>
    </div>
    <div class="preview" (click)="focusGraph(AvailableGraph.AvailableNodes)" [class.focused]="focusedGraph === AvailableGraph.AvailableNodes">
        <div class="label">Available nodes</div>
        <bl-history-graph [max]="pool.targetNodes" class="small-preview" [history]="runningNodesHistory.history" [interactive]="false"
            [historySize]="selectedHistoryLength.value">
        </bl-history-graph>
    </div>
    <div class="preview" (click)="focusGraph(AvailableGraph.RunningTasks)" [class.focused]="focusedGraph === AvailableGraph.RunningTasks">
        <div class="label">Running tasks</div>
        <bl-history-graph [max]="maxRunningTasks" class="small-preview" [history]="runningTaskHistory.history" [interactive]="false"
            [historySize]="selectedHistoryLength.value">
        </bl-history-graph>
    </div>
    <div class="preview" (click)="focusGraph(AvailableGraph.Cpu)" [class.focused]="focusedGraph === AvailableGraph.Cpu">
        <div class="label">Cpu</div>
        <bl-cpu-usage-graph [data]="performanceData" [interactive]="false" class="small-preview"></bl-cpu-usage-graph>
    </div>
    <!-- <div class="preview" (click)="focusGraph(AvailableGraph.Memory)" [class.focused]="focusedGraph === AvailableGraph.Memory">
        <div class="label">Memory</div>
        <bl-performance-graph metric="memory" [data]="performanceData" [interactive]="false" class="small-preview"></bl-performance-graph>
    </div>
    <div class="preview" (click)="focusGraph(AvailableGraph.Disk)" [class.focused]="focusedGraph === AvailableGraph.Disk">
        <div class="label">Disk</div>
        <bl-performance-graph metric="disk" [data]="performanceData" [interactive]="false" class="small-preview"></bl-performance-graph>
    </div>
    <div class="preview" (click)="focusGraph(AvailableGraph.Network)" [class.focused]="focusedGraph === AvailableGraph.Network">
        <div class="label">Network</div>
        <bl-performance-graph metric="network" [data]="performanceData" [interactive]="false" class="small-preview"></bl-performance-graph>
    </div> -->
    <div class="config">
        <mat-form-field>
            <mat-select [formControl]="selectedHistoryLength" placeholder="History">
                <mat-option [value]="historyLength.OneMinute">1 Minute</mat-option>
                <mat-option [value]="historyLength.TenMinute">10 Minutes</mat-option>
                <mat-option [value]="historyLength.OneHour">1 Hour</mat-option>
            </mat-select>
        </mat-form-field>
    </div>
</div>

<div class="focused-graph" [ngSwitch]="focusedGraph">
    <div *ngSwitchCase="AvailableGraph.Heatmap" class="full-display-heatmap">
        <bl-nodes-heatmap [pool]="pool" [nodes]="nodes" [jobs]="jobs"></bl-nodes-heatmap>
    </div>
    <div *ngSwitchCase="AvailableGraph.AvailableNodes" class="full-display">
        <bl-history-graph [max]="pool.targetNodes" class="full-display" [history]="runningNodesHistory.history" [historySize]="selectedHistoryLength.value">
        </bl-history-graph>
    </div>
    <div *ngSwitchCase="AvailableGraph.RunningTasks" class="full-display">
        <bl-history-graph [max]="maxRunningTasks" class="full-display" [history]="runningTaskHistory.history" [historySize]="selectedHistoryLength.value">
        </bl-history-graph>
    </div>
    <div *ngSwitchCase="AvailableGraph.Cpu" class="full-display">
        <bl-cpu-usage-graph [data]="performanceData" class="full-display"></bl-cpu-usage-graph>
    </div>
    <div *ngSwitchCase="AvailableGraph.Memory" class="full-display">
        <bl-performance-graph metric="memory" [data]="performanceData" class="full-display"></bl-performance-graph>
    </div>
    <div *ngSwitchCase="AvailableGraph.Disk" class="full-display">
        <bl-performance-graph metric="disk" [data]="performanceData" class="full-display"></bl-performance-graph>
    </div>
    <div *ngSwitchCase="AvailableGraph.Network" class="full-display">
        <bl-performance-graph metric="network" [data]="performanceData" class="full-display"></bl-performance-graph>
    </div>
</div>
